% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generer_markdown.R
\name{generer_markdown_auto}
\alias{generer_markdown_auto}
\title{Genere un rapport RMarkdown automatise à partir d'une table de demandes et d'une liste de graphiques ou de tables.}
\usage{
generer_markdown_auto(
  table_demandes,
  out,
  out_ollama = NULL,
  fonction_ask_ollama = NULL,
  metadata = NULL,
  prompt_header = NULL,
  prompt_instruction = NULL,
  output_dir = "output/",
  nom_rapport = "rapport_automatique.Rmd"
)
}
\arguments{
\item{table_demandes}{Un data frame contenant au moins les colonnes suivantes :
\describe{
\item{\code{titre}}{Les titres des graphiques ou tables à inclure dans le rapport.}
\item{\code{nom_onglet}}{Les sous-titres ou sections sous lesquelles les elements seront regroupes.}
\item{\code{nom_fichier_xls}}{Le nom du fichier Excel associe. Une chaîne vide indique un element Markdown.}
}}

\item{out}{Une liste contenant les graphiques (objets ggplot) et les tables (data frames) à inclure dans le rapport.
Chaque element de la liste doit correspondre à un titre dans \code{table_demandes$titre}.}

\item{out_ollama}{Liste optionnelle contenant les sorties d'Ollama à inclure dans le rapport.}

\item{fonction_ask_ollama}{Fonction optionnelle pour interroger Ollama.}

\item{metadata}{Donnees supplementaires optionnelles pour la generation des prompts Ollama.}

\item{prompt_header}{En-tête optionnel pour les prompts Ollama.}

\item{prompt_instruction}{Instructions optionnelles pour les prompts Ollama.}

\item{model_name}{Nom optionnel du modèle Ollama à utiliser.}

\item{output_dir}{Chemin du répertoire de sortie où sera sauvegardé le rapport. Par défaut "output/".}

\item{nom_rapport}{Nom du fichier RMarkdown généré. Par défaut "rapport_automatique.Rmd".}
}
\value{
Cette fonction ne retourne pas de valeur, mais écrit un fichier RMarkdown dans le répertoire spécifié.
}
\description{
Cette fonction cree un fichier RMarkdown structure qui inclut des graphiques ggplot2 et des tables, organises par sous-titres et titres.
Les graphiques et les tables sont fournis dans une liste, et les titres et sous-titres sont extraits de la table de demandes.
}
\details{
La fonction génère un fichier RMarkdown dans le répertoire spécifié par \code{output_dir}.
Le rapport est structuré avec des sous-titres (niveaux 2) et des titres (niveaux 3) correspondant respectivement à \code{nom_onglet} et \code{titre}.
Les graphiques et les tables sont insérés sous leurs titres correspondants.
Si le répertoire de sortie n'existe pas, il sera créé automatiquement.

Si des paramètres Ollama sont fournis, la fonction peut enrichir le rapport avec des commentaires générés par l'IA.
}
\examples{
\dontrun{
# Exemple d'utilisation de generer_markdown_auto

# Préparation de la table des demandes
table_demandes <- data.frame(
  titre = c("Graphique 1", "Tableau 1", "Graphique 2"),
  nom_onglet = c("Section A", "Section A", "Section B"),
  nom_fichier_xls = c("", "", ""),  # Ajout de cette colonne manquante
  table = c("table1", "table2", "table3"),  # Ajout de cette colonne manquante
  stringsAsFactors = FALSE
)

# Création des graphiques et tables
library(ggplot2)
plot1 <- ggplot(mtcars, aes(x = wt, y = mpg)) + geom_point()
table1 <- head(mtcars)
plot2 <- ggplot(iris, aes(x = Sepal.Length, y = Petal.Length)) + geom_point()

# Liste des objets à inclure
out <- list(plot1, table1, plot2)

# Génération simple du rapport
generer_markdown_auto(table_demandes, out)

# Exemple avec Ollama (si disponible)
out_ollama <- list(table1, table1, table1)
fonction_ask_ollama <- function(prompt, model_name) { 
  return("Analyse générée par IA") 
}
generer_markdown_auto(
  table_demandes, 
  out,
  out_ollama = out_ollama,
  fonction_ask_ollama = fonction_ask_ollama,
  model_name = "mon_modele"
)

# Rendu du rapport en HTML
rmarkdown::render("output/rapport_automatique.Rmd")
}

}
